<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Humanize.org — Minimal MVP</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #198754cf;
    }
    .brand-area {
      text-align: center;
      padding: 14px 0;
    }
    .brand-area .brand {
      font-weight: 700;
      font-size: 1.5rem;
    }
    .brand-area .tagline {
      font-size: .9rem;
      color: #6c757d;
    }
    .card + .card { margin-top: 1rem; }
  </style>
</head>
<body>

<nav class="navbar navbar-light bg-light border-bottom">
  <div class="container-fluid justify-content-center text-center brand-area">
    <div class="brand-area">
      <span class="brand mb-0 d-block">Humanize.org</span>
      <span class="tagline">Make your text sound human in one click.</span>
    </div>
  </div>
</nav>

<main class="container my-4">
  <div class="text-center mb-4">
    <h2 class="fw-bold mb-1">Enhance your writing in seconds</h2>
    <p class="text-muted">A lightweight, client-side tool. No signups, no servers — just results in your browser.</p>
  </div>

  <!-- Input Section -->
  <div class="row mb-3">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label for="inputText" class="form-label mb-0">Input</label>
            <span id="wordCountInput" class="text-muted small">Words: 0 / 2000</span>
          </div>
          <textarea id="inputText" class="form-control" rows="8" placeholder="Paste your text here…"></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="row mb-3">
    <div class="col text-center">
      <button id="btnHumanize" class="btn btn-primary btn-lg me-2" type="button">Humanize Text</button>
      <button id="btnClear" class="btn btn-outline-secondary btn-lg" type="button">Clear</button>
    </div>
  </div>

  <!-- Spinner -->
  <div id="spinnerRow" class="row justify-content-center d-none mb-3">
    <div class="col-auto d-flex align-items-center">
      <div class="spinner-border text-primary" role="status" aria-label="Processing"></div>
      <span class="ms-2 text-dark">Processing…</span>
    </div>
  </div>

  <!-- Output Section -->
  <div class="row g-3">
    <div class="col-12">
      <div class="card" aria-live="polite">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="card-title mb-0">Humanized Text</h5>
            <button id="btnCopy" class="btn btn-outline-secondary btn-sm" type="button">Copy</button>
          </div>
          <textarea id="outputText" class="form-control" rows="8" placeholder="Your humanized text will appear here…" readonly></textarea>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const input = document.getElementById('inputText');
  const output = document.getElementById('outputText');
  const btnHumanize = document.getElementById('btnHumanize');
  const btnClear = document.getElementById('btnClear');
  const btnCopy = document.getElementById('btnCopy');
  const spinnerRow = document.getElementById('spinnerRow');
  const wordCountInput = document.getElementById('wordCountInput');
  const maxWords = 2000;

  function countWords(text) {
    if (!text) return 0;
    return text.trim().length === 0 ? 0 : text.trim().split(/\s+/).length;
  }

  function updateWordCount() {
    const w = countWords(input.value);
    wordCountInput.textContent = 'Words: ' + w + ' / ' + maxWords;
  }

  input.addEventListener('input', updateWordCount);
  updateWordCount();

  function showSpinner(show) {
    spinnerRow.classList.toggle('d-none', !show);
  }

  function clampWords(text) {
    const w = countWords(text);
    if (w <= maxWords) return text;
    const tokens = text.trim().split(/\s+/).slice(0, maxWords);
    return tokens.join(' ');
  }

  function humanizeText(text) {
    if (!text) return '';

    let t = text;

    // Contractions
    const contractions = [
      {re: /\bdo\s+not\b/gi, rep: "don't"},
      {re: /\bdoes\s+not\b/gi, rep: "doesn't"},
      {re: /\bcan\s+not\b/gi, rep: "can't"},
      {re: /\bcannot\b/gi, rep: "can't"},
      {re: /\bit\s+is\b/gi, rep: "it's"},
      {re: /\bi\s+am\b/gi, rep: "I'm"},
      {re: /\bwe\s+are\b/gi, rep: "we're"},
      {re: /\byou\s+are\b/gi, rep: "you're"},
      {re: /\bthey\s+are\b/gi, rep: "they're"},
      {re: /\bthat\s+is\b/gi, rep: "that's"},
      {re: /\bis\s+there\b/gi, rep: "there's"},
    ];
    contractions.forEach(c => { t = t.replace(c.re, c.rep); });

    // Casual phrases
    const phrases = {
      "therefore": "so",
      "therefore,": "so,",
      "henceforth": "from now on",
      "thus": "so",
      "thereby": "so",
      "consequently": "so",
      "accordingly": "so",
      "however": "but",
      "nevertheless": "but",
    };
    Object.entries(phrases).forEach(([key, val]) => {
      const re = new RegExp("\\b" + key.replace(/[.*+?^${}()|[\\]\\\\]/g, "\\$&") + "\\b", "gi");
      t = t.replace(re, val);
    });

    // Synonyms randomization
    const synonyms = {
      "good": ["great","awesome","nice","solid","excellent"],
      "bad": ["poor","awful","not great","subpar"],
      "quick": ["fast","rapid","swift","speedy"],
      "slow": ["sluggish","lethargic","gradual"],
      "easy": ["simple","straightforward","effortless"],
      "hard": ["difficult","tough","challenging"],
      "small": ["tiny","little","compact"],
      "big": ["large","huge","vast"],
      "happy": ["glad","pleased","cheerful"],
      "sad": ["down","unhappy","melancholy"],
    };
    Object.keys(synonyms).forEach(key => {
      const arr = synonyms[key];
      const re = new RegExp("\\b" + key + "\\b", "gi");
      t = t.replace(re, function(match) {
        const repl = arr[Math.floor(Math.random() * arr.length)];
        // preserve capitalization
        if (match.charAt(0) === match.charAt(0).toUpperCase()) {
          return repl.charAt(0).toUpperCase() + repl.slice(1);
        }
        return repl;
      });
    });

    // Variation: split long sentences
    const sentences = t.split(/([.!?])\s+/);
    let rebuilt = [];
    for (let i = 0; i < sentences.length; i++) {
      const part = sentences[i];
      // keep delimiters intact
      if (i % 2 === 0) {
        // text
        rebuilt.push(part);
      } else {
        // punctuation
        rebuilt.push(part);
      }
    }
    t = rebuilt.join(' ').trim();

    // Optional split of very long sentences to vary length
    const frag = t.split(/[.!?]+\s+/);
    if (frag.length > 1) {
      const newParts = [];
      frag.forEach(s => {
        const w = s.trim().split(/\s+/).length;
        if (w > 20 && Math.random() < 0.25) {
          const words = s.trim().split(/\s+/);
          const mid = Math.floor(words.length / 2);
          const first = words.slice(0, mid).join(' ');
          const second = words.slice(mid).join(' ');
          if (first) newParts.push(first + '.');
          if (second) newParts.push(second);
        } else {
          if (s.trim()) newParts.push(s.trim());
        }
      });
      t = newParts.join('. ');
      t = t.replace(/\s+([.!?])/g, '$1');
    }

    // Normalize whitespace
    t = t.replace(/\s+/g, ' ').trim();

    return t;
  }

  btnHumanize.addEventListener('click', function() {
    const raw = input.value;
    const clamped = clampWords(raw);
    if (countWords(raw) > maxWords) {
      alert('Input exceeds the maximum of ' + maxWords + ' words. Extra text has been trimmed.');
    }
    showSpinner(true);
    output.value = '';
    setTimeout(function() {
      const result = humanizeText(clamped);
      output.value = result;
      showSpinner(false);
    }, 350);
  });

  btnClear.addEventListener('click', function() {
    input.value = '';
    output.value = '';
    updateWordCount();
  });

  btnCopy.addEventListener('click', function() {
    const text = output.value;
    if (!text) return;
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).then(function() {
        btnCopy.textContent = 'Copied';
        setTimeout(function() { btnCopy.textContent = 'Copy'; }, 1200);
      });
    } else {
      const ta = document.createElement('textarea');
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      document.body.removeChild(ta);
      btnCopy.textContent = 'Copied';
      setTimeout(function() { btnCopy.textContent = 'Copy'; }, 1200);
    }
  });

  updateWordCount();
});
</script>

</body>
</html>
