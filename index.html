<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Humanizer - Smart Offline</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .container { max-width: 900px; margin-top: 50px; }
    .card { border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    textarea { resize: none; min-height: 200px; }
    .btn-custom {
      background: #4CAF50; color: white;
      border-radius: 25px; padding: 10px 30px;
      font-size: 18px; font-weight: bold;
    }
    .btn-custom:hover { background: #45a049; color: white; }
    .spinner-border { display: none; margin-left: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card p-4">
      <h2 class="text-center mb-4">AI Humanizer (Offline Smart Mode)</h2>
      
      <!-- Input Section -->
      <label for="inputText" class="form-label">Paste your AI text here:</label>
      <textarea id="inputText" class="form-control mb-3" placeholder="Paste AI-generated text here..."></textarea>

      <div class="text-center">
        <button id="humanizeBtn" class="btn btn-custom" onclick="humanizeText()">Humanize</button>
        <div id="loadingSpinner" class="spinner-border text-success" role="status"></div>
      </div>

      <!-- Output Section -->
      <div class="mt-4">
        <label for="outputText" class="form-label">Humanized Text:</label>
        <textarea id="outputText" class="form-control" placeholder="Your humanized text will appear here..." readonly></textarea>
      </div>
    </div>
  </div>

  <script>
    function shuffleSentences(paragraph) {
      let sentences = paragraph.match(/[^.!?]+[.!?]/g) || [paragraph];
      if (sentences.length > 3) {
        // swap middle sentences randomly
        let i = 1 + Math.floor(Math.random() * (sentences.length - 2));
        let j = 1 + Math.floor(Math.random() * (sentences.length - 2));
        [sentences[i], sentences[j]] = [sentences[j], sentences[i]];
      }
      return sentences.join(" ");
    }

    function humanizeText() {
      const inputEl = document.getElementById("inputText");
      const outputEl = document.getElementById("outputText");
      const buttonEl = document.getElementById("humanizeBtn");
      const spinnerEl = document.getElementById("loadingSpinner");

      let text = inputEl.value.trim();
      if (!text) {
        alert("Please paste some text first!");
        return;
      }

      // Lock input + show spinner
      inputEl.disabled = true;
      buttonEl.disabled = true;
      spinnerEl.style.display = "inline-block";
      outputEl.value = "";

      setTimeout(() => {
        // Step 1: contractions
        text = text.replace(/\bdo not\b/gi, "don't")
                   .replace(/\bcan not\b/gi, "can't")
                   .replace(/\bit is\b/gi, "it's")
                   .replace(/\bthey are\b/gi, "they're")
                   .replace(/\bwe are\b/gi, "we're");

        // Step 2: synonyms + phrase swaps
        const replacements = {
          "moreover": ["also", "whatâ€™s more", "on top of that"],
          "therefore": ["so", "which means", "as a result"],
          "artificial intelligence": ["AI", "machine intelligence", "smart systems"],
          "in conclusion": ["to sum up", "overall", "all things considered"],
          "utilize": ["use", "make use of", "take advantage of"],
          "demonstrates": ["shows", "highlights", "makes clear"]
        };
        for (let word in replacements) {
          let options = replacements[word];
          let regex = new RegExp("\\b" + word + "\\b", "gi");
          text = text.replace(regex, () => {
            return options[Math.floor(Math.random() * options.length)];
          });
        }

        // Step 3: break long paragraphs into smaller chunks
        let paragraphs = text.split(/\n+/).map(p => p.trim()).filter(p => p);
        let newParagraphs = [];
        for (let p of paragraphs) {
          // apply mild sentence shuffle
          p = shuffleSentences(p);

          if (p.length > 300) {
            let mid = Math.floor(p.length / 2);
            let cut = p.indexOf(".", mid);
            if (cut !== -1) {
              newParagraphs.push(p.slice(0, cut+1));
              newParagraphs.push(p.slice(cut+1));
              continue;
            }
          }
          newParagraphs.push(p);
        }

        // Step 4: optional filler / casual tone
        let finalText = newParagraphs.join("\n\n");
        if (Math.random() > 0.6) {
          finalText = "Honestly, " + finalText;
        }
        if (Math.random() > 0.7) {
          finalText += " You know, that's kind of the gist of it.";
        }

        // Step 5: output clean text
        outputEl.value = finalText.trim();
        inputEl.disabled = false;
        buttonEl.disabled = false;
        spinnerEl.style.display = "none";
      }, 1300); // simulate processing
    }
  </script>
</body>
</html>
